<!DOCTYPE html>
<html lang="en" class="astro-CZ7FPPW4">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/fonts/dank-mono.css">
    <link rel="me" href="https://mas.to/@snugug">
    <link rel="manifest" href="/manifest.webmanifest">
    <meta name="generator" content="Astro v1.6.2">
    <title>A Modern Take on Cutting the Mustard | Snugug</title>
    <meta name="description" content="By taking advantage of JavaScript module support, we can update the Cutting the Mustard progressive enhancement technique to allow for modern JavaScript syntaxes and features!">
  <link rel="stylesheet" href="/assets/cookbook.eff5e9a5.css" />
<link rel="stylesheet" href="/assets/_slug_.baf2ea72.css" /><script type="module">"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"})});
</script></head>
  <body class="body astro-CZ7FPPW4">
    <style>astro-island,astro-slot{display:contents}</style><script>(self.Astro=self.Astro||{}).load=a=>{(async()=>await(await a())())()},window.dispatchEvent(new Event("astro:load"));var l;{const c={0:t=>t,1:t=>JSON.parse(t,o),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(JSON.parse(t,o)),5:t=>new Set(JSON.parse(t,o)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(JSON.parse(t)),9:t=>new Uint16Array(JSON.parse(t)),10:t=>new Uint32Array(JSON.parse(t))},o=(t,s)=>{if(t===""||!Array.isArray(s))return s;const[e,n]=s;return e in c?c[e](n):void 0};customElements.get("astro-island")||customElements.define("astro-island",(l=class extends HTMLElement{constructor(){super(...arguments);this.hydrate=()=>{if(!this.hydrator||this.parentElement&&this.parentElement.closest("astro-island[ssr]"))return;const s=this.querySelectorAll("astro-slot"),e={},n=this.querySelectorAll("template[data-astro-template]");for(const r of n){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(const r of s){const i=r.closest(this.tagName);!i||!i.isSameNode(this)||(e[r.getAttribute("name")||"default"]=r.innerHTML)}const a=this.hasAttribute("props")?JSON.parse(this.getAttribute("props"),o):{};this.hydrator(this)(this.Component,a,e,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),window.removeEventListener("astro:hydrate",this.hydrate),window.dispatchEvent(new CustomEvent("astro:hydrate"))}}connectedCallback(){!this.hasAttribute("await-children")||this.firstChild?this.childrenConnectedCallback():new MutationObserver((s,e)=>{e.disconnect(),this.childrenConnectedCallback()}).observe(this,{childList:!0})}async childrenConnectedCallback(){window.addEventListener("astro:hydrate",this.hydrate);let s=this.getAttribute("before-hydration-url");s&&await import(s),this.start()}start(){const s=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(Astro[e]===void 0){window.addEventListener(`astro:${e}`,()=>this.start(),{once:!0});return}Astro[e](async()=>{const n=this.getAttribute("renderer-url"),[a,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),i=this.getAttribute("component-export")||"default";if(!i.includes("."))this.Component=a[i];else{this.Component=a;for(const d of i.split("."))this.Component=this.Component[d]}return this.hydrator=r,this.hydrate},s,this)}attributeChangedCallback(){this.hydrator&&this.hydrate()}},l.observedAttributes=["props"],l))}</script><astro-island uid="1w70kw" component-url="/Menu.bd5d2339.js" component-export="default" renderer-url="/client.788af3ea.js" props="{&quot;class&quot;:[0,&quot;astro-CZ7FPPW4&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Menu&quot;,&quot;value&quot;:true}" await-children=""><div><button class="toggle svelte-1g8b6wp" aria-expanded="false" aria-label="Open menu"></button>

  <nav class="menu svelte-1g8b6wp" aria-expanded="false"><ul class="menu--list svelte-1g8b6wp"><li><a href="/" tabindex="-1">Home</a></li>
      <li><a href="/musings" tabindex="-1">Posts</a></li>
      <li><a href="/cookbook" tabindex="-1">Cookbook</a></li>
      <li><a href="/me" tabindex="-1">About</a></li>
      <li><a href="/presentations" tabindex="-1">Presentations</a></li>
      <li><a href="/rss.xml" tabindex="-1">RSS</a></li></ul></nav>
</div></astro-island>

    <div class="body-content astro-CZ7FPPW4">
      <main itemscope="" itemtype="http://schema.org/Blog" class="astro-UBUQI6KS">
    <article class="article astro-UBUQI6KS">
      <header class="article--heading astro-UBUQI6KS">
        <div class="heading heading--padded astro-3D5OBTLG" style="--hue: 25;--saturation: 30;--lightness: 80;--alpha: 0.2;--size: 125;">
  <h1 class="heading--title astro-3D5OBTLG" itemprop="name">A Modern Take on Cutting the Mustard</h1>
</div>


      </header>
      <div class="article--container astro-UBUQI6KS">
        <div class="article--inner astro-UBUQI6KS">
          <p class="article--date astro-UBUQI6KS">
            
            <time datetime="2018-07-29T00:00:00.000Z" class="astro-UBUQI6KS">7/29/2018
            </time>
          </p>
          <div class="article--content type astro-UBUQI6KS"><p>One of the easiest ways to <a href="https://alistapart.com/article/understandingprogressiveenhancement">progressively enhance</a> your web experience is the <a href="http://responsivenews.co.uk/post/18948466399/cutting-the-mustard">Cutting the Mustard</a> technique. The essence of Cutting the Mustard is:</p>
<ol>
<li>Provide an accessible base-line experience for everyone using semantic HTML and CSS</li>
<li>Write a test for a minimum subset of JavaScript functionality to support.
<ul>
<li>If the test <em>passes</em>, enhance the experience with modern JavaScript</li>
<li>If the test <em>fails</em>, enhance enhance the experience with older JavaScript (and usually a subset of the modern JavaScript’s functionality)</li>
</ul>
</li>
</ol>
<p>The original test was developed by the BBC team to distinguish between HTML5 browsers and non-HTML5 browsers. That test was fairly straight forward:</p>
<figure><pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token string">'querySelector'</span> <span class="token keyword">in</span> <span class="token dom variable">document</span> <span class="token operator">&amp;&amp;</span> <span class="token string">'localStorage'</span> <span class="token keyword">in</span> <span class="token dom variable">window</span> <span class="token operator">&amp;&amp;</span> <span class="token string">'addEventListener'</span> <span class="token keyword">in</span> <span class="token dom variable">window</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Enhance for HTML5 browsers</span>
<span class="token punctuation">}</span>
</code></pre></figure><p>This works really well! The enhancements being looked for are all functions that hang off of <code>document</code> or <code>window</code> and can looked for using checks, so we use these tests even in browsers that don’t support that functionality! Our progressive enhancement life is wonderful!</p>
<section>
<h2 id="enter-es2015" tabindex="-1"><a class="header-anchor" href="#enter-es2015">Enter ES2015+</a></h2>
<p>Starting with ES2015, or ES6, new JavaScript functionality started to be added that couldn’t be tested for by checking if a property exists; it introduced some actual new JavaScript syntax, like <code>const</code>, <code>let</code>, arrow functions, and classes. The problem we now face wanting to test for support of these new syntaxes is that we can’t even <em>write</em> the new syntax and deliver it to browsers that don’t support it without errors! This is because, unlike HTML and CSS which can gracefully ignore unsupported syntax, JavaScript can’t! How, then, can we Cut the Mustard in a way that won’t cause errors in unsupported browsers without compiling or transpiling our modern JavaScript syntax?</p>
<p><strong>JavaScript Modules to the Rescue</strong></p>
</section>
<section>
<h2 id="using-modules-to-cut-the-mustard" tabindex="-1"><a class="header-anchor" href="#using-modules-to-cut-the-mustard">Using Modules to Cut the Mustard</a></h2>
<p>Let’s get straight to the code, then we’ll explain it:</p>
<figure><pre class="language-markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./mustard.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nomodule</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./no-mustard.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- Can be done inline too --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword module">import</span> <span class="token imports">mustard</span> <span class="token keyword module">from</span> <span class="token string">'./mustard.js'</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nomodule</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'No Mustard!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre></figure><p>When JavaScript modules were introduced, two new bits of HTML syntax were introduced that make this all possible: <code>type=&quot;module&quot;</code> for <code>&lt;script&gt;</code> tags, and the <code>nomodule</code> attribute.</p>
<p>In all browsers that <a href="https://caniuse.com/#feat=es6-module">support JavaScript module via <code>script</code> tags</a>, <code>&lt;script type=&quot;module&quot;&gt;</code> will be interpreted as a JavaScript module and loaded and run as expected, but for browsers that don’t recognize that type, it’ll just be ignored because it’s unknown HTML syntax! Easy Peasy! Mustard, cut.</p>
<p>We can also “test” for the opposite by including the <code>nomodule</code> attribute. In all browsers that support <code>type=&quot;module&quot;</code> (except Safari 10.1 and iOS Safari 10.3), adding the <code>nomodule</code> attribute to out <code>&lt;script&gt;</code> tags will have that JavaScdipt ignored in module-supporting browsers while it’ll load and run as expected in all other browsers! While it’s not <em>absolutely perfect</em> coverage (less than 1% of browsers globally will fall in to this category at the time of this writing), it’s likely good enough for most production work.</p>
</section>
<section>
<h2 id="whats-our-new-baseline" tabindex="-1"><a class="header-anchor" href="#whats-our-new-baseline">What’s Our New Baseline</a></h2>
<p>Using JavaScript modules as our new baseline gives us a <a href="https://caniuse.com/#compare=edge+16,firefox+60,chrome+61,safari+10.1,opera+48,ios_saf+10.3,and_chr+67,and_ff+60">great modern baseline</a> of HTML, CSS, and JavaScript functionality that we can just <em>know</em> is available to us. Some JavaScript highlights from this list are:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const"><code>const</code></a> and partial <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let"><code>let</code></a> support</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promises</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">async functions</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API"><code>fetch</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">Arrow functions</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters">Rest parameters</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes">Classes</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">Template Literals</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator">Generators</a></li>
<li>And, of course, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">JavaScript Modules</a></li>
</ul>
<p>That’s quite a bit of new syntax we get <em>out of the box</em> by setting our baseline to JavaScript modules. This is, of course, in addition to everything we can test for and use that’s <em>not</em> based on new syntax, like Service Workers and Intersection Observers. We can even do it on a feature-by-feature basis:</p>
<figure><pre class="language-js"><code class="language-js"><span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token string">'IntersectionObserver'</span> <span class="token keyword">in</span> <span class="token dom variable">window</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Intersection Observers, GO!</span>
<span class="token punctuation">}</span>
</code></pre></figure><p>With the power of JavaScript modules as a modern Cutting the Mustard technique, we have a modern JavaScript baseline we can code to. Combined with our tried-and-true progressive enhancement feature testing, it may finally be time to put down our compilers and transpilers and start delivering cutting-edge JavaScript straight from editor to browser.</p>
</section>
</div>
        </div>
      </div>
    </article>
  </main>
    </div>

    <footer class="footer svelte-1bt7hha"><div class="inner svelte-1bt7hha"><img src="/images/me/square.jpg" alt="Headshot of Sam" class="headshot svelte-1bt7hha" loading="lazy">
    <h2 class="svelte-1bt7hha">Sam <br><span class="aka">aka</span>
      <a class="type--a svelte-1bt7hha" href="/links">Snugug</a></h2>
    <p class="svelte-1bt7hha">BBQ lead, ChromeOS DevRel</p>
    <p class="svelte-1bt7hha">Web, design, development, food</p></div>
</footer>

    

    <script>(self.Astro=self.Astro||{}).only=t=>{(async()=>await(await t())())()},window.dispatchEvent(new Event("astro:only"));</script><astro-island uid="MIwod" component-url="/Houdini.3bbc1370.js" component-export="default" renderer-url="/client.788af3ea.js" props="{&quot;class&quot;:[0,&quot;astro-CZ7FPPW4&quot;]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Houdini&quot;,&quot;value&quot;:true}"></astro-island>
  
</body></html>

